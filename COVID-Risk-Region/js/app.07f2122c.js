(function(){"use strict";var e={2171:function(e,t,i){var l=i(9242),n=(i(451),i(9060),i(9200),i(7086),i(6570),i(970)),r=i(9740),a=(i(3189),i(5065)),o=i(3396);const d={class:"footer-section"},s=(0,o.Uk)(" 数据来自"),h=(0,o.Uk)("国家卫健委"),c=(0,o.Uk)(" | "),u=(0,o.Uk)("GitHub"),f=(0,o.Uk)(" | "),_=(0,o.Uk)("Api GitHub");function g(e,t,i,l,n,r){const g=a.E2;return(0,o.wg)(),(0,o.iD)("div",d,[s,(0,o.Wm)(g,{class:"link",href:"http://bmfw.www.gov.cn/yqfxdjcx/risk.html",target:"_blank"},{default:(0,o.w5)((()=>[h])),_:1}),c,(0,o.Wm)(g,{class:"link",href:"https://github.com/panghaibin/COVID-Risk-Region",target:"_blank"},{default:(0,o.w5)((()=>[u])),_:1}),f,(0,o.Wm)(g,{class:"link",href:"https://github.com/panghaibin/RiskLevelAPI",target:"_blank"},{default:(0,o.w5)((()=>[_])),_:1})])}var p={name:"FooterShow"},m=i(89);const w=(0,m.Z)(p,[["render",g],["__scopeId","data-v-69ea89f7"]]);var y=w,k=(i(8009),i(6710),i(6809),i(1430),i(172),i(8474),i(877)),b=i(5188),v=i(6605),x=i(1902),S=i(3533),I=i(1015),C=i(7139);const O=e=>((0,o.dD)("data-v-7205509f"),e=e(),(0,o.Cn)(),e),W={key:0},j={key:0},N={key:1},T={class:"high-risk"},U=(0,o.Uk)(" 高风险等级地区 "),A={class:"num"},D={class:"middle-risk"},E=(0,o.Uk)(" 中风险等级地区 "),z={class:"num"},$={key:1},M=O((()=>(0,o._)("p",null,"API 获取出错，请刷新重试",-1)));function F(e,t,i,n,r,a){const d=(0,o.up)("loading"),s=I.gn,h=S.EZ,c=x.Ks,u=v.mi,f=b.y,_=k.vk;return r.err?((0,o.wg)(),(0,o.iD)("div",$,[M,(0,o._)("p",null,(0,C.zw)(r.err_msg),1)])):((0,o.wg)(),(0,o.iD)("div",W,[(0,o._)("p",null,[r.ok?((0,o.wg)(),(0,o.iD)("span",j,"以下信息截止自 "+(0,C.zw)(r.raw.data.end_update_time),1)):((0,o.wg)(),(0,o.iD)("span",N,"加载中……")),(0,o.wy)((0,o._)("span",null,[(0,o.Wm)(s,{class:"is-loading"},{default:(0,o.w5)((()=>[(0,o.Wm)(d)])),_:1})],512),[[l.F8,r.loading_icon]])]),(0,o.Wm)(h,{disabled:!r.ok,ref:"filter_input",modelValue:r.filter_text,"onUpdate:modelValue":t[0]||(t[0]=e=>r.filter_text=e),placeholder:"请输入区域名称，可用空格分隔多个关键词",clearable:"",onClear:t[1]||(t[1]=t=>a.tag_add(e.$refs.filter_input.input.value)),onChange:a.tag_add},null,8,["disabled","modelValue","onChange"]),(0,o._)("div",{class:(0,C.C_)(r.ok?"tag-list":["tag-list","tag-list-disabled"])},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.filter_history,((t,i)=>((0,o.wg)(),(0,o.j4)(c,{type:r.dark_mode?"info":"",key:i,closable:!0,onClose:e=>a.tag_remove(i),onClick:i=>{e.$refs.filter_input.focus(),r.filter_text=t,a.tag_add(t)},class:"tag-item"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,C.zw)(t),1)])),_:2},1032,["type","onClose","onClick"])))),128))],2),(0,o._)("h3",T,[U,(0,o._)("span",A,"("+(0,C.zw)(r.high.count)+")",1),(0,o.Wm)(u,{class:"expand-all",type:r.dark_mode?"info":"primary",onClick:a.high_expand,disabled:!r.ok},{default:(0,o.w5)((()=>[(0,o.Uk)((0,C.zw)(r.high.expand_all_button),1)])),_:1},8,["type","onClick","disabled"])]),r.ok?((0,o.wg)(),(0,o.j4)(f,{key:r.high.key,data:r.high.tree,props:r.tree_props,"node-key":"id","default-expand-all":r.high.expand_all,"default-expanded-keys":r.high.default_id_list,"auto-expand-parent":!1,ref:"high_tree","filter-node-method":a.high_filter,"empty-text":"无数据"},null,8,["data","props","default-expand-all","default-expanded-keys","filter-node-method"])):((0,o.wg)(),(0,o.j4)(_,{key:1,rows:6,animated:""})),(0,o._)("h3",D,[E,(0,o._)("span",z,"("+(0,C.zw)(r.middle.count)+")",1),(0,o.Wm)(u,{class:"expand-all",type:r.dark_mode?"info":"primary",onClick:a.middle_expand,disabled:!r.ok},{default:(0,o.w5)((()=>[(0,o.Uk)((0,C.zw)(r.middle.expand_all_button),1)])),_:1},8,["type","onClick","disabled"])]),r.ok?((0,o.wg)(),(0,o.j4)(f,{key:r.middle.key,data:r.middle.tree,props:r.tree_props,"node-key":"id","default-expand-all":r.middle.expand_all,"default-expanded-keys":r.middle.default_id_list,"auto-expand-parent":!1,ref:"middle_tree","filter-node-method":a.middle_filter,"empty-text":"无数据"},null,8,["data","props","default-expand-all","default-expanded-keys","filter-node-method"])):((0,o.wg)(),(0,o.j4)(_,{key:3,rows:6,animated:""}))]))}var P=i(6265),R=i.n(P),H=i(6693),J=(i(8742),{name:"RegionShow",props:{data_url:String},data(){return{raw:null,ok:!1,err:!1,err_msg:"",high:{key:0,tree:null,count:"-",province_id_list:[],city_id_list:[],county_id_list:[],default_id_list:[],expand_all:!1,expand_all_button:"展开"},middle:{key:0,tree:null,count:"-",province_id_list:[],city_id_list:[],county_id_list:[],default_id_list:[],expand_all:!1,expand_all_button:"展开"},tree_props:{label:"label",children:"children",class:"tree-node"},filter_text:"",filter_history:["北京","上海","江苏"],dark_mode:!1,loading_icon:!1}},mounted(){let e="true"===localStorage.getItem("use_proxy");localStorage.getItem("latest_timestamp")&&localStorage.getItem("latest")?(this.raw=JSON.parse(localStorage.getItem("latest")),this.high_init(),this.middle_init(),this.ok=!0,(new Date).getTime()-localStorage.getItem("latest_timestamp")>3e5&&(this.loading_icon=!0,this.fetch_data(this.data_url+"?t="+(new Date).getTime(),e))):(this.loading_icon=!0,this.fetch_data(this.data_url+"?t="+(new Date).getTime(),e)),localStorage.getItem("filter_history")&&""!==localStorage.getItem("filter_history")&&"[]"!==localStorage.getItem("filter_history")?this.filter_history=JSON.parse(localStorage.getItem("filter_history")):localStorage.setItem("filter_history",JSON.stringify(this.filter_history));let t=window.matchMedia("(prefers-color-scheme: dark)"),i=this,l=e=>{i.dark_mode=e.matches};t.addEventListener("change",l),l(t)},methods:{fetch_data:function(e,t){let i,l,n;n="https://gh.hbtech.workers.dev/",i=t?n+e:e,l=t?1e4:3e3;let r=R().CancelToken;const a=r.source(),o=setTimeout((()=>{a.cancel()}),l);let d=this;R().get(i,{cancelToken:a.token}).then((function(e){clearTimeout(o);let i,l=e.data,n=!1;d.ok?d.raw.data["end_update_time"]!==l.data["end_update_time"]?(i="数据更新成功",n=!0):i="已是最新数据":(i="数据加载成功",n=!0),H.bM.success({message:i,duration:2500,position:"bottom-right",showClose:!1,customClass:"notification-item"}),n&&(d.raw=l,d.high_init(),d.middle_init(),d.ok=!0,localStorage.setItem("latest",JSON.stringify(l))),localStorage.setItem("latest_timestamp",(new Date).getTime().toString()),localStorage.setItem("use_proxy",t.toString())})).catch((function(i){if(clearTimeout(o),console.log(i),t)if(d.ok){let e="数据更新失败<br>已显示缓存数据";H.bM.info({message:e,duration:2500,position:"bottom-right",showClose:!1,customClass:"notification-item",dangerouslyUseHTMLString:!0})}else d.err_msg=i,d.err=!0;else d.fetch_data(e,!0)})).finally((function(){d.loading_icon=!1}))},list2tree(e,t){let i=[],l=0,n=[],r=[],a=[];for(let o=0;o<e.length;o++){let t=e[o],d=t["province"],s=t.city,h=t["county"],c=t["communitys"],u=null,f=null,_=null,g=null;for(let e=0;e<i.length;e++){let t=i[e];if(t.label===d){u=t;break}}null===u&&(u={id:l++,pid:-1,label:d,children:[],expanded:!0},i.push(u),n.push(u.id));for(let e=0;e<u.children.length;e++){let t=u.children[e];if(t.label===s){f=t;break}}null===f&&(f={id:l++,pid:u.id,label:s,children:[],expanded:!0},u.children.push(f),r.push(f.id));for(let e=0;e<f.children.length;e++){let t=f.children[e];if(t.label===h){_=t;break}}null===_&&(_={id:l++,pid:f.id,label:h,children:[],expanded:!0},f.children.push(_),a.push(_.id));for(let e=0;e<_.children.length;e++){let t=_.children[e];if(t.label===c){g=t;break}}if(null===g){g=[];for(let e=0;e<c.length;e++)_.children.push({id:l++,pid:_.id,label:c[e]})}}t.tree=i,t.province_id_list=n,t.city_id_list=r,t.county_id_list=a,t.default_id_list=n.concat(a)},high_init(){this.list2tree(this.raw.data["highlist"],this.high),this.high.key++,this.high.count=this.raw.data["hcount"]},middle_init(){this.list2tree(this.raw.data["middlelist"],this.middle),this.middle.key++,this.middle.count=this.raw.data["mcount"]},high_expand(){if(this.high.expand_all=!this.high.expand_all,this.high.expand_all){let e=this.high.default_id_list.concat(this.high.city_id_list);for(let t=0;t<e.length;t++)this.$refs.high_tree.store.getNode(e[t]).expanded=!0}else for(let e=0;e<this.high.city_id_list.length;e++)this.$refs.high_tree.store.getNode(this.high.city_id_list[e]).expanded=!1;this.high.expand_all_button=this.high.expand_all?"收起":"展开"},middle_expand(){if(this.middle.expand_all=!this.middle.expand_all,this.middle.expand_all){let e=this.middle.default_id_list.concat(this.middle.city_id_list);for(let t=0;t<e.length;t++)this.$refs.middle_tree.store.getNode(e[t]).expanded=!0}else for(let e=0;e<this.middle.city_id_list.length;e++)this.$refs.middle_tree.store.getNode(this.middle.city_id_list[e]).expanded=!1;this.middle.expand_all_button=this.middle.expand_all?"收起":"展开"},high_filter(e,t){if(!e)return void 0===t.children&&this.high.count++,!0;let i=e.split(" ");for(let l=0;l<i.length;l++){let e=i[l];if(!e)continue;if(t.label.includes(e))return void 0===t.children&&this.high.count++,!0;let n=t.pid;while(-1!==n){let i=this.$refs.high_tree.store.getNode(n).data;if(i.label.includes(e))return void 0===t.children&&this.high.count++,!0;n=i.pid}}return!1},middle_filter(e,t){if(!e)return void 0===t.children&&this.middle.count++,!0;let i=e.split(" ");for(let l=0;l<i.length;l++){let e=i[l];if(!e)continue;if(t.label.includes(e))return void 0===t.children&&this.middle.count++,!0;let n=t.pid;while(-1!==n){let i=this.$refs.middle_tree.store.getNode(n).data;if(i.label.includes(e))return void 0===t.children&&this.middle.count++,!0;n=i.pid}}return!1},tag_add(e){if(e=e.trim(),""!==e){while(e.includes("  "))e=e.replace("  "," ");this.filter_history.unshift(e),this.filter_history=Array.from(new Set(this.filter_history)),localStorage.setItem("filter_history",JSON.stringify(this.filter_history))}},tag_remove(e){this.filter_history.splice(e,1),localStorage.setItem("filter_history",JSON.stringify(this.filter_history))}},watch:{filter_text(e){e=e.trim();while(e.includes("  "))e=e.replace("  "," ");this.high.count=0,this.$refs.high_tree.filter(e),this.middle.count=0,this.$refs.middle_tree.filter(e)}}});const L=(0,m.Z)(J,[["render",F],["__scopeId","data-v-7205509f"]]);var G=L;const V={class:"content-body"},Z={class:"content"};function K(e,t,i,l,a,d){const s=(0,o.up)("Head"),h=r.nZ,c=G,u=r.b2,f=y,_=r.F_,g=r.G4,p=n.Mr;return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o._)("title",null,(0,C.zw)(a.title),1)])),_:1}),(0,o.Wm)(p,{height:"100vh"},{default:(0,o.w5)((()=>[(0,o._)("div",V,[(0,o._)("div",Z,[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{class:"header"},{default:(0,o.w5)((()=>[(0,o._)("h1",null,(0,C.zw)(a.title),1)])),_:1}),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{data_url:a.api_url},null,8,["data_url"])])),_:1}),(0,o.Wm)(_,{class:"footer"},{default:(0,o.w5)((()=>[(0,o.Wm)(f)])),_:1})])),_:1})])])])),_:1})],64)}var q=i(2350),Y={data(){return{refreshing:!1,registration:null,updateExists:!1}},created(){document.addEventListener("swUpdated",this.updateAvailable,{once:!0}),navigator.serviceWorker.addEventListener("controllerchange",(()=>{this.refreshing||(this.refreshing=!0,window.location.reload())}))},methods:{updateAvailable(e){this.registration=e.detail,this.updateExists=!0,this.refreshApp()},refreshApp(){this.updateExists=!1,this.registration&&this.registration.waiting&&this.registration.waiting.postMessage({type:"SKIP_WAITING"})}}};let B="https://raw.githubusercontent.com/panghaibin/RiskLevelAPI/api/latest.json";var Q={name:"App",components:{RegionShow:G,FooterShow:y,Head:q.Fb},data(){return{title:"全国疫情中高风险地区查询",api_url:B}},mixins:[Y]};const X=(0,m.Z)(Q,[["render",K]]);var ee=X,te=i(9907);(0,te.z)("/COVID-Risk-Region/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(e){console.log("Service worker has been registered and now polling for updates."),setInterval((()=>{e.update()}),5e3)},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(e){console.log("New content is available; please refresh."),document.dispatchEvent(new CustomEvent("swUpdated",{detail:e}))},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var ie=i(6911);const le=(0,l.ri)(ee);for(const[re,ae]of Object.entries(ie))le.component(re,ae);const ne=(0,q.G6)();le.use(ne),le.mount("#app")}},t={};function i(l){var n=t[l];if(void 0!==n)return n.exports;var r=t[l]={exports:{}};return e[l](r,r.exports,i),r.exports}i.m=e,function(){var e=[];i.O=function(t,l,n,r){if(!l){var a=1/0;for(h=0;h<e.length;h++){l=e[h][0],n=e[h][1],r=e[h][2];for(var o=!0,d=0;d<l.length;d++)(!1&r||a>=r)&&Object.keys(i.O).every((function(e){return i.O[e](l[d])}))?l.splice(d--,1):(o=!1,r<a&&(a=r));if(o){e.splice(h--,1);var s=n();void 0!==s&&(t=s)}}return t}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[l,n,r]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var l in t)i.o(t,l)&&!i.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,l){var n,r,a=l[0],o=l[1],d=l[2],s=0;if(a.some((function(t){return 0!==e[t]}))){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(d)var h=d(i)}for(t&&t(l);s<a.length;s++)r=a[s],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(h)},l=self["webpackChunkcovid_risk_region"]=self["webpackChunkcovid_risk_region"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=i.O(void 0,[998],(function(){return i(2171)}));l=i.O(l)})();
//# sourceMappingURL=app.07f2122c.js.map