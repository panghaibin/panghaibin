(function(){"use strict";var t={4838:function(t,e,i){var l=i(9242),n=(i(451),i(9060),i(9200),i(7086),i(6570),i(970)),a=i(9740),r=(i(3189),i(5065)),d=i(3396);const o={class:"footer-section"},s=(0,d.Uk)(" 数据来自"),h=(0,d.Uk)("国家卫健委"),u=(0,d.Uk)(" | "),c=(0,d.Uk)("GitHub"),_=(0,d.Uk)(" | "),f=(0,d.Uk)("Api GitHub");function g(t,e,i,l,n,a){const g=r.E2;return(0,d.wg)(),(0,d.iD)("div",o,[s,(0,d.Wm)(g,{class:"link",href:"http://bmfw.www.gov.cn/yqfxdjcx/risk.html",target:"_blank"},{default:(0,d.w5)((()=>[h])),_:1}),u,(0,d.Wm)(g,{class:"link",href:"https://github.com/panghaibin/COVID-Risk-Region",target:"_blank"},{default:(0,d.w5)((()=>[c])),_:1}),_,(0,d.Wm)(g,{class:"link",href:"https://github.com/panghaibin/RiskLevelAPI",target:"_blank"},{default:(0,d.w5)((()=>[f])),_:1})])}var p={name:"FooterShow"},m=i(89);const w=(0,m.Z)(p,[["render",g],["__scopeId","data-v-e056256a"]]);var y=w,k=(i(8009),i(6710),i(6809),i(1430),i(172),i(94)),b=i(4477),v=i(6605),x=i(1902),S=i(5879),I=i(7139);const C=t=>((0,d.dD)("data-v-4274a9ff"),t=t(),(0,d.Cn)(),t),O={key:0},W={key:0},j={key:1},D={class:"high-risk"},U=(0,d.Uk)(" 高风险等级地区 "),N={class:"num"},$={class:"middle-risk"},z=(0,d.Uk)(" 中风险等级地区 "),H={class:"num"},T={key:1},A=C((()=>(0,d._)("p",null,"API 获取出错，请刷新重试",-1)));function J(t,e,i,l,n,a){const r=S.EZ,o=x.Ks,s=v.mi,h=b.y,u=k.vk;return n.err?((0,d.wg)(),(0,d.iD)("div",T,[A,(0,d._)("p",null,(0,I.zw)(n.err_msg),1)])):((0,d.wg)(),(0,d.iD)("div",O,[n.ok?((0,d.wg)(),(0,d.iD)("p",W,"以下信息截止自"+(0,I.zw)(n.raw.data.end_update_time),1)):((0,d.wg)(),(0,d.iD)("p",j,"加载中……")),(0,d.Wm)(r,{disabled:!n.ok,ref:"filter_input",modelValue:n.filter_text,"onUpdate:modelValue":e[0]||(e[0]=t=>n.filter_text=t),placeholder:"请输入区域名称",clearable:"",onClear:e[1]||(e[1]=e=>a.tag_add(t.$refs.filter_input.input.value)),onChange:a.tag_add},null,8,["disabled","modelValue","onChange"]),(0,d._)("div",{class:(0,I.C_)(n.ok?"tag-list":["tag-list","tag-list-disabled"])},[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(n.filter_history,((e,i)=>((0,d.wg)(),(0,d.j4)(o,{key:i,closable:!0,onClose:t=>a.tag_remove(i),onClick:i=>{t.$refs.filter_input.focus(),n.filter_text=e,a.tag_add(e)},class:"tag-item"},{default:(0,d.w5)((()=>[(0,d.Uk)((0,I.zw)(e),1)])),_:2},1032,["onClose","onClick"])))),128))],2),(0,d._)("h3",D,[U,(0,d._)("span",N,"("+(0,I.zw)(n.high.count)+")",1),(0,d.Wm)(s,{ref:"high_button",class:"expand-all",type:"primary",onClick:a.high_expand,disabled:!n.ok},{default:(0,d.w5)((()=>[(0,d.Uk)((0,I.zw)(n.high.expand_all_button),1)])),_:1},8,["onClick","disabled"])]),n.ok?((0,d.wg)(),(0,d.j4)(h,{key:2,data:n.high.tree,props:n.tree_props,"node-key":"id","default-expand-all":n.high.expand_all,"default-expanded-keys":n.high.default_id_list,"auto-expand-parent":!1,ref:"high_tree","filter-node-method":a.high_filter,"empty-text":"无数据"},null,8,["data","props","default-expand-all","default-expanded-keys","filter-node-method"])):((0,d.wg)(),(0,d.j4)(u,{key:3,rows:6,animated:""})),(0,d._)("h3",$,[z,(0,d._)("span",H,"("+(0,I.zw)(n.middle.count)+")",1),(0,d.Wm)(s,{class:"expand-all",type:"primary",onClick:a.middle_expand,disabled:!n.ok},{default:(0,d.w5)((()=>[(0,d.Uk)((0,I.zw)(n.middle.expand_all_button),1)])),_:1},8,["onClick","disabled"])]),n.ok?((0,d.wg)(),(0,d.j4)(h,{key:4,data:n.middle.tree,props:n.tree_props,"node-key":"id","default-expand-all":n.middle.expand_all,"default-expanded-keys":n.middle.default_id_list,"auto-expand-parent":!1,ref:"middle_tree","filter-node-method":a.middle_filter,"empty-text":"无数据"},null,8,["data","props","default-expand-all","default-expanded-keys","filter-node-method"])):((0,d.wg)(),(0,d.j4)(u,{key:5,rows:6,animated:""}))]))}var R=i(6265),F=i.n(R),M=i(6693),P=(i(8742),{name:"RegionShow",props:{data_url:String},data(){return{raw:null,ok:!1,err:!1,err_msg:"",high:{tree:null,count:"-",province_id_list:[],city_id_list:[],county_id_list:[],default_id_list:[],expand_all:!1,expand_all_button:"展开"},middle:{tree:null,count:"-",province_id_list:[],city_id_list:[],county_id_list:[],default_id_list:[],expand_all:!1,expand_all_button:"展开"},tree_props:{label:"label",children:"children",class:"tree-node"},filter_text:"",filter_history:["北京","上海","江苏"]}},mounted(){let t="true"===localStorage.getItem("use_proxy");localStorage.getItem("latest_timestamp")&&localStorage.getItem("latest")?(this.raw=JSON.parse(localStorage.getItem("latest")),this.high_init(),this.middle_init(),this.ok=!0,(new Date).getTime()-localStorage.getItem("latest_timestamp")>3e5&&this.fetch_data(this.data_url+"?t="+(new Date).getTime(),t)):this.fetch_data(this.data_url+"?t="+(new Date).getTime(),t),localStorage.getItem("filter_history")&&""!==localStorage.getItem("filter_history")&&"[]"!==localStorage.getItem("filter_history")?this.filter_history=JSON.parse(localStorage.getItem("filter_history")):localStorage.setItem("filter_history",JSON.stringify(this.filter_history))},methods:{fetch_data:function(t,e){let i;i=e?"https://gh.hbtech.workers.dev/"+t:t;let l=this;F().get(i).then((function(t){let i,n=t.data,a=!1;l.ok?l.raw.data["end_update_time"]!==n.data["end_update_time"]?(i="数据更新成功",a=!0):i="已是最新数据":(i="数据加载成功",a=!0),M.bM.success({message:i,duration:2500,position:"bottom-right",showClose:!1,customClass:"notification-item"}),a&&(l.raw=n,l.high_init(),l.middle_init(),l.ok=!0,localStorage.setItem("latest",JSON.stringify(n))),localStorage.setItem("latest_timestamp",(new Date).getTime().toString()),localStorage.setItem("use_proxy",e.toString())})).catch((function(i){if(console.log(i),e)if(l.ok){let t="数据更新失败<br>已显示缓存数据";M.bM.info({message:t,duration:2500,position:"bottom-right",showClose:!1,customClass:"notification-item",dangerouslyUseHTMLString:!0})}else l.err_msg=i,l.err=!0;else l.fetch_data(t,!0)}))},list2tree(t,e){let i=[],l=0,n=[],a=[],r=[];for(let d=0;d<t.length;d++){let e=t[d],o=e["province"],s=e.city,h=e["county"],u=e["communitys"],c=null,_=null,f=null,g=null;for(let t=0;t<i.length;t++){let e=i[t];if(e.label===o){c=e;break}}null===c&&(c={id:l++,pid:-1,label:o,children:[],expanded:!0},i.push(c),n.push(c.id));for(let t=0;t<c.children.length;t++){let e=c.children[t];if(e.label===s){_=e;break}}null===_&&(_={id:l++,pid:c.id,label:s,children:[],expanded:!0},c.children.push(_),a.push(_.id));for(let t=0;t<_.children.length;t++){let e=_.children[t];if(e.label===h){f=e;break}}null===f&&(f={id:l++,pid:_.id,label:h,children:[],expanded:!0},_.children.push(f),r.push(f.id));for(let t=0;t<f.children.length;t++){let e=f.children[t];if(e.label===u){g=e;break}}if(null===g){g=[];for(let t=0;t<u.length;t++)f.children.push({id:l++,pid:f.id,label:u[t]})}}e.tree=i,e.province_id_list=n,e.city_id_list=a,e.county_id_list=r,e.default_id_list=n.concat(r)},high_init(){this.list2tree(this.raw.data["highlist"],this.high),this.high.count=this.raw.data["hcount"]},middle_init(){this.list2tree(this.raw.data["middlelist"],this.middle),this.middle.count=this.raw.data["mcount"]},high_expand(){if(this.high.expand_all=!this.high.expand_all,this.high.expand_all){let t=this.high.default_id_list.concat(this.high.city_id_list);for(let e=0;e<t.length;e++)this.$refs.high_tree.store.getNode(t[e]).expanded=!0}else for(let t=0;t<this.high.city_id_list.length;t++)this.$refs.high_tree.store.getNode(this.high.city_id_list[t]).expanded=!1;this.high.expand_all_button=this.high.expand_all?"收起":"展开"},middle_expand(){if(this.middle.expand_all=!this.middle.expand_all,this.middle.expand_all){let t=this.middle.default_id_list.concat(this.middle.city_id_list);for(let e=0;e<t.length;e++)this.$refs.middle_tree.store.getNode(t[e]).expanded=!0}else for(let t=0;t<this.middle.city_id_list.length;t++)this.$refs.middle_tree.store.getNode(this.middle.city_id_list[t]).expanded=!1;this.middle.expand_all_button=this.middle.expand_all?"收起":"展开"},high_filter(t,e){if(!t)return void 0===e.children&&this.high.count++,!0;let i=t.split(" ");for(let l=0;l<i.length;l++){let t=i[l];if(!t)continue;if(e.label.includes(t))return void 0===e.children&&this.high.count++,!0;let n=e.pid;while(-1!==n){let i=this.$refs.high_tree.store.getNode(n).data;if(i.label.includes(t))return void 0===e.children&&this.high.count++,!0;n=i.pid}}return!1},middle_filter(t,e){if(!t)return void 0===e.children&&this.middle.count++,!0;let i=t.split(" ");for(let l=0;l<i.length;l++){let t=i[l];if(!t)continue;if(e.label.includes(t))return void 0===e.children&&this.middle.count++,!0;let n=e.pid;while(-1!==n){let i=this.$refs.middle_tree.store.getNode(n).data;if(i.label.includes(t))return void 0===e.children&&this.middle.count++,!0;n=i.pid}}return!1},tag_add(t){if(t=t.trim(),""!==t){while(t.includes("  "))t=t.replace("  "," ");this.filter_history.unshift(t),this.filter_history=Array.from(new Set(this.filter_history)),localStorage.setItem("filter_history",JSON.stringify(this.filter_history))}},tag_remove(t){this.filter_history.splice(t,1),localStorage.setItem("filter_history",JSON.stringify(this.filter_history))}},watch:{filter_text(t){t=t.trim();while(t.includes("  "))t=t.replace("  "," ");this.high.count=0,this.$refs.high_tree.filter(t),this.middle.count=0,this.$refs.middle_tree.filter(t)}}});const Z=(0,m.Z)(P,[["render",J],["__scopeId","data-v-4274a9ff"]]);var G=Z;const V={class:"content-body"},E={class:"content"},L=(0,d._)("h1",null,"全国疫情中高风险地区查询",-1);function K(t,e,i,l,r,o){const s=(0,d.up)("Head"),h=a.nZ,u=G,c=a.b2,_=y,f=a.F_,g=a.G4,p=n.Mr;return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d.Wm)(s,null,{default:(0,d.w5)((()=>[(0,d._)("title",null,(0,I.zw)(r.title),1)])),_:1}),(0,d.Wm)(p,{height:"100vh"},{default:(0,d.w5)((()=>[(0,d._)("div",V,[(0,d._)("div",E,[(0,d.Wm)(g,null,{default:(0,d.w5)((()=>[(0,d.Wm)(h,{class:"header"},{default:(0,d.w5)((()=>[L])),_:1}),(0,d.Wm)(c,null,{default:(0,d.w5)((()=>[(0,d.Wm)(u,{data_url:r.api_url},null,8,["data_url"])])),_:1}),(0,d.Wm)(f,{class:"footer"},{default:(0,d.w5)((()=>[(0,d.Wm)(_)])),_:1})])),_:1})])])])),_:1})],64)}var Y=i(2350);let q="https://raw.githubusercontent.com/panghaibin/RiskLevelAPI/api/latest.json";var B={name:"App",components:{RegionShow:G,FooterShow:y,Head:Y.Fb},data(){return{title:"全国疫情中高风险地区查询",api_url:q}}};const Q=(0,m.Z)(B,[["render",K]]);var X=Q;const tt=(0,l.ri)(X),et=(0,Y.G6)();tt.use(et),tt.mount("#app")}},e={};function i(l){var n=e[l];if(void 0!==n)return n.exports;var a=e[l]={exports:{}};return t[l](a,a.exports,i),a.exports}i.m=t,function(){var t=[];i.O=function(e,l,n,a){if(!l){var r=1/0;for(h=0;h<t.length;h++){l=t[h][0],n=t[h][1],a=t[h][2];for(var d=!0,o=0;o<l.length;o++)(!1&a||r>=a)&&Object.keys(i.O).every((function(t){return i.O[t](l[o])}))?l.splice(o--,1):(d=!1,a<r&&(r=a));if(d){t.splice(h--,1);var s=n();void 0!==s&&(e=s)}}return e}a=a||0;for(var h=t.length;h>0&&t[h-1][2]>a;h--)t[h]=t[h-1];t[h]=[l,n,a]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var l in e)i.o(e,l)&&!i.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:e[l]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,l){var n,a,r=l[0],d=l[1],o=l[2],s=0;if(r.some((function(e){return 0!==t[e]}))){for(n in d)i.o(d,n)&&(i.m[n]=d[n]);if(o)var h=o(i)}for(e&&e(l);s<r.length;s++)a=r[s],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(h)},l=self["webpackChunkcovid_risk_region"]=self["webpackChunkcovid_risk_region"]||[];l.forEach(e.bind(null,0)),l.push=e.bind(null,l.push.bind(l))}();var l=i.O(void 0,[998],(function(){return i(4838)}));l=i.O(l)})();
//# sourceMappingURL=app.534260af.js.map